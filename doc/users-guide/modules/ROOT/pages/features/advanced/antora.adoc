Software Download using SWDP CLI

Release 1.0

image::vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image1.jpeg[image,width=793,height=373]

[width="100%",cols="100%",options="header",]
|===
|User Guide
|March 2024
|*© 2024 Nokia. Nokia Confidential Information* +
Use subject to agreed restrictions on disclosure and use.
|===

*Legal Notice*

Nokia is committed to diversity and inclusion. We are continuously
reviewing our customer documentation and consulting with standards
bodies to ensure that terminology is inclusive and aligned with the
industry. Our future customer documentation will be updated accordingly.

____________________________

This document includes Nokia proprietary and confidential information,
which may not be distributed or disclosed to any third parties without
the prior written consent of Nokia.

This document is intended for use by Nokia’s customers (“You”/”Your”) in
connection with a product purchased or licensed from any company within
Nokia Group of Companies. Use this document as agreed. You agree to
notify Nokia of any errors you may find in this document; however,
should you elect to use this document for any purpose(s) for which it is
not intended, You understand and warrant that any determinations You may
make or actions You may take will be based upon Your independent
judgment and analysis of the content of this document.

Nokia reserves the right to make changes to this document without
notice. At all times, the controlling version is the one available on
Nokia’s site.

No part of this document may be modified.

NO WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT
LIMITED TO ANY WARRANTY OF AVAILABILITY, ACCURACY, RELIABILITY, TITLE,
NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE,
IS MADE IN RELATION TO THE CONTENT OF THIS DOCUMENT. IN NO EVENT WILL
NOKIA BE LIABLE FOR ANY DAMAGES, INCLUDING BUT NOT LIMITED TO SPECIAL,
DIRECT, INDIRECT, INCIDENTAL OR CONSEQUENTIAL OR ANY LOSSES, SUCH AS BUT
NOT LIMITED TO LOSS OF PROFIT, REVENUE, BUSINESS INTERRUPTION, BUSINESS
OPPORTUNITY OR DATA THAT MAY ARISE FROM THE USE OF THIS DOCUMENT OR THE
INFORMATION IN IT, EVEN IN THE CASE OF ERRORS IN OR OMISSIONS FROM THIS
DOCUMENT OR ITS CONTENT.

Copyright and trademark: Nokia is a registered trademark of Nokia
Corporation. Other product names mentioned in this document may be
trademarks of their respective owners.

© 2024 Nokia.

:toc-title: Contents

link:#overview[1. Overview link:#overview[4]]

link:#swdp-download-sites[2. SWDP download sites
link:#swdp-download-sites[4]]

link:#_Toc162857002[3. Access Token management link:#_Toc162857002[5]]

link:#access-token-management-using-cli[3.1 Access token management
using CLI link:#access-token-management-using-cli[5]]

link:#prerequisite[3.1.1 Prerequisite link:#prerequisite[5]]

link:#generating-an-access-token[3.1.2 Generating an access token
link:#generating-an-access-token[5]]

link:#revoking-the-access-token[3.1.3 Revoking the access token
link:#revoking-the-access-token[6]]

link:#access-token-management-using-swdp-portal-availability-to-be-announced-later[3.2
Access token management using SWDP Portal (Availability to be announced
later)
link:#access-token-management-using-swdp-portal-availability-to-be-announced-later[6]]

link:#logging-in-to-swdp-portal[3.2.1 Logging in to SWDP Portal
link:#logging-in-to-swdp-portal[7]]

link:#managing-access-tokens-using-swdp-portal[3.2.2 Managing access
tokens using SWDP Portal
link:#managing-access-tokens-using-swdp-portal[9]]

link:#software-download[4. Software download
link:#software-download[14]]

link:#generic-file-download[4.1 Generic file download
link:#generic-file-download[14]]

link:#helm-chart-download[4.2 Helm chart download
link:#helm-chart-download[14]]

link:#docker-image-download[4.3 Docker image download
link:#docker-image-download[15]]

link:#definition-and-acronyms[5. Definition and acronyms
link:#definition-and-acronyms[16]]

____
____

== Overview

Nokia’s Software Delivery Platform (SWDP) offers a fully integrated and
automated solution to deliver software to Nokia customers.

This user guide describes the Command Line Interface (CLI) method to:

* Generate and manage tokens that are required to access the SWDP
system.
* Download software artifacts from SWDP.

____
Examples and commands are included for your reference.
____

== SWDP download sites

SWDP has two sites that can be used to download software:

* A site in Finland for all customers except the United States, and
* A site in the US for customers in the US.

Depending on the connection (VPN or no-VPN) between your system and the
SWDP download site, you can download using the following URLs:

[width="100%",cols="24%,34%,42%",options="header",]
|===
|*SWDP download site* a|
*From public internet*

*(Availability to be announced)*

|*From Nokia VPN*
|FI (for non-US customers)
|https://swdp-fi.support.nokia.com/[https://swdp-fi.support.nokia.com]
|https://swdp-pull-fin.swdp.dyn.nesc.nokia.net/[https://swdp-pull-fin.swdp.dyn.nesc.nokia.net]

|US (for US customers)
|https://swdp-us.support.nokia.com/[https://swdp-us.support.nokia.com] 
|https://pull-us.swdp.dyn.nesc.nokia.net/[https://pull-us.swdp.dyn.nesc.nokia.net]
|===

== Access Token management

To access the SWDP download site via CLI, you will need a Personal
Access Token (PAT).

Authentication to the SWDP download site is done using the username PAT
and a generated access token.

The access token is generated and managed either using a dedicated
service under the SWDP web GUI or using dedicated SWDP download site
endpoint(s). The access token is decrypted on the SWDP side, and
credentials are checked against Nokia users Active Directory.

Credentials must be passed via HTTP Basic Authentication (HTTP Header
Authorization containing base64-encoded credentials).

=== Access token management using CLI

This section explains how to generate or revoke an access token using
CLI.

==== Prerequisite

Ensure that you have access to the
file:///C:\Users\gequirog\AppData\Local\Microsoft\Windows\INetCache\Content.Outlook\CWR6J1WQ\(https:\customer.nokia.com\support\s\)[Nokia
Support Portal]. The registration guide to the Nokia Support Portal is
available on the portal website.

For SWDP token generation, you need to specify the same credentials
(email address and password) that you use to access the Nokia Support
Portal.

==== Generating an access token

[arabic]
. To generate the access token, run the command below:

curl <__hostname__>/api/v1/token/create -u <__email address__> -X POST

===== The -u option is used to specify your Nokia Support Portal email address for authentication. 

* You are prompted to enter a password.

[arabic, start=2]
. Enter the same password you use to access Nokia Support Portal.

===== The token is valid for 3 months, after which the user must generate a new token.

Example:

curl https://swdp-pull-fi.swdp.dyn.nesc.nokia.nethttps://interceptor.generic-finland-pull-cluster.near-sandbox.swdp.dyn.nesc.nokia.net/api/v1/token/create[/api/v1/token/create] -u john.smith@example.com
-X POST

*IMPORTANT:*

Token generation is limited to 20 requests per minute per IP address.
Whenever the limit is reached, error 429 is displayed.

*CAUTION:*

DO NOT ENTER THE PASSWORD DIRECTLY INTO THE COMMAND LINE!

The password should *be always* provided via the *prompt*. With this
approach, it is ensured the password is not left in any bash history.

==== Revoking the access token 

When you no longer need a token, you can revoke it.

===== Revoke only one token

To revoke only one specific token, run the command below using the value
PAT (personal access token) as username. When prompted for a password,
the revoked token must be used:

curl <__hostname__>/api/v1/token/revoke -u PAT -X POST

Once the command is run, the token will be removed.

===== Revoke all tokens for a given authentication username (user mail, country code, end user id)

To revoke all tokens related to a specific authentication username, run
the curl command shown below. When prompted for a password, the user
password in LDAP must be used:

curl <__hostname__>/api/v1/token/revoke/all -u <__email address__> -X
POST

This will remove all tokens of the given authentication username.

=== Access token management using SWDP Portal (Availability to be announced later)

This section will cover how to generate a token, view or delete a token
using the SWDP Portal**.**

SWDP Portal offers two web portal URLs to create access tokens:

* To create tokens for a customer located in the United States, use:
https://portal.pull-us.swdp.dyn.nesc.nokia.net/
* To create tokens for a non-US customer, use:
+
https://portal.swdp-pull-fin.swdp.dyn.nesc.nokia.net/

Figure 1 SWDP Portal landing page

image:vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image3.tmp[View of
SWDP Portal,width=690,height=218]

==== Logging in to SWDP Portal 

On the SWDP Portal, click the *Login* button at the top-right corner.

* Pick your account from the list shown, or
* Click the *Use another account* button to sign in with a different
email and password.

===== Pick an Account

If you see your credentials in the displayed list, click on it:

Figure 2 Accounts available when logging in.

image:vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image4.tmp[A
screenshot of a computer Description automatically
generated,width=520,height=261]

Once you click your account, you will be logged in.

===== Use Another Account

If you do not see your account, click the *Use another account* button,
then type your email:

Figure 3 Sign in window

image:vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image5.tmp[A
screenshot of a computer Description automatically
generated,width=337,height=309]

Then type your password:

Figure 4 Password Window

image:vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image6.tmp[A
screenshot of a login page Description automatically
generated,width=337,height=261]

* If logging in for the first time, then a pop-up window is displayed
asking you to grant access. Click *Accept* to grant access.
* After 1 hour of inactivity, if you click on any element, you will be
automatically redirected to the login page.

____
____

==== Managing access tokens using SWDP Portal

In this section you will be guided on how to navigate the SWDP Portal to
create, delete and view token(s).

===== Access Tokens

After you have logged into the SWDP Portal, you will see the landing
page. Click the *Access Tokens* button:

Figure 5 SWDP Portal after successful login

image:vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image7.tmp[A
screenshot of a computer Description automatically
generated,width=631,height=373]

You will see the Token Management Page. From here, you can generate,
delete and view your token(s):

Figure 6 Access token window

image:vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image8.png[A
screenshot of a computer Description automatically
generated,width=626,height=364]

===== Generating a token

[arabic]
. To create a token, click the *Generate Token* button.

A new pop-up window will appear, asking you to provide a name to your
token.

* Type a unique name meeting the following criteria:
* Starts and ends with an alphanumeric character.
* Does not contain any other characters.
** Max 64 characters.
** May contain alphanumeric characters or hyphens.

*NOTE*: Country code and Customer ID will be automatically populated and
are not editable.

____
Figure 7 Generate new access token dialog box

image:vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image9.tmp[A
screenshot of a login page Description automatically
generated,width=468,height=304]
____

After Typing the name, click *Submit* button.

[arabic, start=2]
. The next pop-up window will contain the token.

____
Figure 8 Token created dialog box

image:vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image10.tmp[A
screenshot of a computer error Description automatically
generated,width=435,height=249]
____

* Make sure to copy it now and store it in a safe place. It will not be
shown to you again.

[arabic, start=3]
. After you copy your token, click the *Close* button.
. You will see your previous and recently created token names.

Figure 9 Access token window

image:vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image11.png[A
screenshot of a computer Description automatically
generated,width=631,height=228]

===== Delete Tokens

There are two options for deleting tokens:

* Select one or more tokens to delete individually, or
* Delete all your tokens at once.

To delete one or multiple tokens, click the checkbox next to each
token's name, then click the *Delete selected* button. A confirmation
message displays. Click *Yes* to delete the selected tokens.

Figure 10 Selection of token(s) to be deleted.

image:vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image12.png[A
screenshot of a computer Description automatically
generated,width=540,height=173]

If you want to delete all tokens at once, click the *Delete all* button.
You will be prompted to confirm your choice to delete all your access
tokens. Click *Yes* to delete all tokens.

Figure 11 Delete all Tokens pop-up window

image:vertopal_d3e6b4b81fbe4c9f949a61de1dd34e30/media/image13.png[A
screenshot of a computer Description automatically
generated,width=447,height=189]

===== Expiration of a token

If you have any token(s) that are about to expire, you will receive an
email notification with the information from each token. If you still
need the token(s), make sure to create new ones on the SWDP Portal.

* Email notification is set to two weeks, one week, one day and the day
of expiration of the token. Expired tokens get deleted once the last
notification is sent on day of expiration.

== Software download

There are three types of download commands described in this section:

* Generic file download
* Helm chart download
* Docker image download

=== Generic file download 

The generic file download is completed using the wget command.

[arabic]
. Run the following wget command:

wget --http-user=PAT --ask-password https://<__swdp download
site__>/artifactory/<__product-name__>-Product/<__file-path__>  

* The --http-user option is used to specify the username for HTTP
authentication, which is a static value PAT (personal access token).
* The --ask-password option prompts the user to enter a token for
authentication.

[arabic, start=2]
. {blank}
+
____
Enter the token to proceed with download.
____

*Example:*

End customer downloading a file for Altiplano Access Controller:

$ wget
--http-user=PAT --ask-password https://swdp-fi.support.nokia.com/artifactory/Altiplano-Access-Controller-Product/21.6.2/21.6.2/INSTALL_MEDIA/product.txt[https://swdp-fi.support.nokia.com]https://swdp-fi.support.nokia.com/artifactory/Altiplano-Access-Controller-Product/21.6.2/21.6.2/METADATA/product.txt[/artifactory/Altiplano-Access-Controller-Product/21.6.2/21.6.2/]https://swdp-fi.support.nokia.com/artifactory/Altiplano-Access-Controller-Product/21.6.2/21.6.2/INSTALL_MEDIA/product.txt[INSTALL_MEDIA/product.txt]

=== Helm chart download

The Helm chart download must be started with the helm repo command. Once
this command is entered, then other helm commands can be used. Following
is the format for the helm repo command:

helm repo add <__reponame__>
<__hostname__>/artifactory/<__product-name__>-Helm --username PAT --password
<__token__> --pass-credentials

*Example: *

helm repo add
altiplano https://swdp-fi.support.nokia.com/artifactory/Altiplano-Access-Controller-Product-Helm --username PAT --password
<token> --pass-credentials

After that, the regular helm commands will work:

helm search repo altiplano-infra –versions –devel

helm pull aprepo/altiplano-infra --version 21.12.1-REL-0216

helm pull fmcrepo/altiplano-infra --version 21.12.1-REL-0216

=== Docker image download

Run the following command to log in to Docker:

docker login https://<__product name__>-docker.<__hostname__> -u PAT

*Example:*

docker
login https://altiplano-access-controller-product-docker.swdp-fi.support.nokia.com/[https://altiplano-access-controller-product-docker.swdp-fi.support.nokia.com] -u
PAT 

After logging in, enter the access token, when prompted.

After that, the regular docker commands will work:

docker
pull http://altiplano-access-controller-product-docker.swdp-fi.support.nokia.com/anv:21.12.1-REL_251[altiplano-access-controller-product-docker.swdp-fi.support.nokia.com/anv:21.12.1-REL_251] +
docker
pull http://altiplano-fastmile-controller-product-docker.swdp-fi.support.nokia.com/anv:21.12.1-REL_251[altiplano-fastmile-controller-product-docker.swdp-fi.support.nokia.com/anv:21.12.1-REL_251]

== Definition and acronyms 

[width="100%",cols="25%,75%",options="header",]
|===
|Term |Definition
|Generic File |A file of the lowest delivery level of a product

|Helm Chart |A Helm chart is a package format. It is also known as
containerized software

|Docker image |A Docker image is a lightweight, standalone, executable
package that contains everything needed to run a piece of software,
including the code, runtime, libraries, and dependencies.

|HTTP Basic Authentication |Involves the process of securely accessing
web resources via commands in a terminal or console. The method
described in this guide is token-based.

|Token |Is a unique and encrypted piece of data used for authentication
|===

[width="100%",cols="25%,75%",options="header",]
|===
|Acronym |Definition
|CLI |Command Line Interface

|HTTP |Hypertext Transfer Protocol 

|SWDP a|
Software Delivery Platform

Common name for the ecosystem consisting of SEaDOC and NEAR

|PAT |Personal Access Token

|LDAP |Lightweight Directory Access Protocol

|GUI |Graphical User Interface

|API |Application Programming Interface

|VPN |Virtual Private Network

|CURL |Client URL

|SEaDOC a|
Software Entitlement and Delivery Orchestration Center

Based on the eccenca Corporate Memory solution. Links the commercial
entitlement to the detailed technical product structure, orchestrates
the SW distribution, orchestrates delivery compliance checks.

|NEAR a|
Nokia Enterprise Artifacts Repository

Is the main SW Repository of SWDP. Its based on JFrog’s Enterprise
solution, which is an end-to-end universal DevOps platform for CI/CD
pipelines and includes all JFrog products such as Artifactory,
Distribution and Mission Control.

|===

